{
  "_comment": "Sample PreCompact hook input - triggered before context window compaction",

  "hook_type": "PreCompact",
  "timestamp": "2024-01-15T11:00:00Z",

  "session_info": {
    "session_id": "session-2024-01-15-abc123",
    "started_at": "2024-01-15T10:30:00Z",
    "project_path": "E:\\ai-dev\\physics91-claude-plugin"
  },

  "context_metrics": {
    "current_tokens": 185000,
    "max_tokens": 200000,
    "usage_percentage": 92.5,
    "compaction_reason": "approaching_limit"
  },

  "conversation": {
    "total_messages": 24,
    "user_messages": 12,
    "assistant_messages": 12,
    "messages": [
      {
        "role": "user",
        "content": "I need to implement a new feature for user authentication.",
        "timestamp": "2024-01-15T10:30:00Z"
      },
      {
        "role": "assistant",
        "content": "I'll help you create a login component. Let me first check the existing authentication setup.",
        "timestamp": "2024-01-15T10:30:15Z",
        "tool_calls": [
          {
            "tool": "Glob",
            "parameters": {"pattern": "**/auth/**/*.ts"}
          }
        ]
      },
      {
        "role": "user",
        "content": "Yes, please check the AuthService first and then create the component.",
        "timestamp": "2024-01-15T10:31:00Z"
      },
      {
        "role": "assistant",
        "content": "I'll read the AuthService to understand the existing authentication logic.",
        "timestamp": "2024-01-15T10:31:30Z",
        "tool_calls": [
          {
            "tool": "Read",
            "parameters": {"file_path": "src/auth/AuthService.ts"}
          },
          {
            "tool": "TodoWrite",
            "parameters": {
              "todos": [
                {"content": "Review AuthService", "status": "completed"},
                {"content": "Create LoginComponent", "status": "in_progress"},
                {"content": "Add tests", "status": "pending"}
              ]
            }
          }
        ]
      }
    ]
  },

  "active_todos": [
    {
      "content": "Create LoginComponent with form validation",
      "status": "in_progress",
      "activeForm": "Creating LoginComponent with form validation"
    },
    {
      "content": "Add unit tests for LoginComponent",
      "status": "pending",
      "activeForm": "Adding unit tests for LoginComponent"
    }
  ],

  "tool_usage_summary": {
    "total_calls": 45,
    "by_tool": {
      "Read": 15,
      "Write": 8,
      "Edit": 12,
      "Glob": 5,
      "Grep": 3,
      "TodoWrite": 2
    }
  },

  "files_in_context": [
    "src/components/LoginComponent.tsx",
    "src/auth/AuthService.ts",
    "src/auth/types.ts",
    "src/utils/validation.ts",
    "tests/components/LoginComponent.test.tsx"
  ],

  "agents_content": {
    "global": "# Global Agent Configuration\n\n## General Guidelines\n- Always use TypeScript strict mode\n- Prefer async/await over callbacks",
    "project": "# Project AGENTS.md\n\n## Subagent Definitions\n\n### code-reviewer\nUse after significant changes."
  },

  "request": {
    "action": "preserve_context",
    "output_format": "context_state",
    "include_agents": true,
    "max_output_size": 50000
  }
}
